From b3e87071aca6eb864362c6b9d7d738f4a46a4ffb Mon Sep 17 00:00:00 2001
From: tinywrkb <tinywrkb@gmail.com>
Date: Sat, 8 May 2021 22:43:31 +0300
Subject: [PATCH] deb: use xdg dirs instead of localstatedir

---
 src/checkers/debianrepochecker.py | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/checkers/debianrepochecker.py b/src/checkers/debianrepochecker.py
index 7ff8572..8414fcb 100644
--- a/src/checkers/debianrepochecker.py
+++ b/src/checkers/debianrepochecker.py
@@ -175,7 +175,12 @@ class DebianRepoChecker(Checker):
             # Setup generic configuration
             apt_pkg.init()
             apt_pkg.config.set("Dir", root)
-            apt_pkg.config.set("Dir::State::status", dpkg_status)
+            apt_pkg.config.set("Dir::State::status", os.path.join(os.getenv('XDG_DATA_HOME'), 'dpkg/status'))
+            apt_pkg.config.set("Dir::State", os.path.join(os.getenv('XDG_DATA_HOME'), 'apt'))
+            apt_pkg.config.set("Dir::Cache", os.path.join(os.getenv('XDG_CACHE_HOME'), 'apt'))
+            apt_pkg.config.set("Dir::Etc::SourceList", os.path.join(os.getenv('XDG_CONFIG_HOME'), 'apt/sources.list'))
+            apt_pkg.config.set("Dir::Etc::Trusted", os.path.join(os.getenv('XDG_CONFIG_HOME'), 'apt/trusted.gpg'))
+            apt_pkg.config.set("Dir::Etc::TrustedParts", os.path.join(os.getenv('XDG_CONFIG_HOME'), 'apt/trusted.gpg.d'))
             apt_pkg.config.set("Acquire::Languages", "none")
             progress = LoggerAcquireProgress(LOG)
 
-- 
2.31.1

