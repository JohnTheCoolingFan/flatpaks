# WARNING: this app was created for experimenting with the wine sdk, and might be removed in the future
# TODO: use shared winetricks cache, add this to the runtime --filesystem=xdg-cache/winetricks:Create
# TODO: runtime xdg-data export from the .var folder to a dedicated export folder of selected resources.
#       example export folder. xdg-data/wine/FLATPAK_ID/{applications,desktop-directories,icons,mime}
#       or xdg-data/applications/flatpak-FLATPAK_ID/
app-id: org.winehq.wine
runtime: org.winehq.Platform
runtime-version: master
sdk: org.winehq.Sdk
command: /bin/sh
finish-args:
  - --filesystem=home
  - --share=network
  # TODO: evalute dbus access
  - --socket=session-bus
  - --socket=system-bus
modules:
  - name: wine
    buildsystem: simple
    build-commands:
      # TODO: add other wine programs, https://wiki.winehq.org/List_of_Commands
      #       hh, ie, winhelp/winhlp32, control, notepad, msiexec, wordpad, progman, regedit,
      #       taskmgr, uninstaller, view, wineconsole, winefile, winemine, clock, cmd, explorer
      #       wine explorer /desktop=shell,1920x1080
      # TODO: install dosbox-staging.desktop?
      - install -Dm644 -t ${FLATPAK_DEST}/share/applications/ ${FLATPAK_ID}{,.winecfg}.desktop
        # sources: dlls/wineandroid.drv/wine.svg
      - install -Dm644 ${FLATPAK_ID}.svg -t ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/
      - install -Dm644 /usr/share/applications/winetricks.desktop ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.winetricks.desktop
      - install -Dm644 /usr/share/icons/hicolor/scalable/apps/winetricks.svg ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.winetricks.svg
      - desktop-file-edit --set-key=Icon --set-value=${FLATPAK_ID}.winetricks ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.winetricks.desktop
    sources:
      - type: file
        path: org.winehq.wine.desktop
      - type: file
        path: org.winehq.wine.winecfg.desktop
      - type: file
        path: org.winehq.wine.svg
