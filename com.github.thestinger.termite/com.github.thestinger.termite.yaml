app-id: com.github.thestinger.termite
runtime: org.gnome.Platform
runtime-version: '3.38'
sdk: org.gnome.Sdk
command: termite
#rename-icon: termite
rename-desktop-file: termite.desktop
finish-args:
  - --device=dri
  - --env=TERMINFO_DIRS='/app/share/terminfo:'
  - --filesystem=home
  - --share=ipc
  - --socket=wayland
  - --socket=x11
  - --talk-name=org.freedesktop.Notifications
  - --talk-name=org.kde.StatusNotifierWatcher
modules:
  - name: termite
    no-autogen: true
    make-install-args:
      - PREFIX=/app
    sources:
      - type: git
        url: https://github.com/thestinger/termite.git
        tag: v15
      - type: shell
        commands:
          - sed 's#etc/xdg#share#' -i Makefile
    modules:
      - name: vte-ng
        config-opts:
          - --enable-static
          - --disable-shared
          - enable_introspection=no
          - enable_vala=no
          - --disable-gtk-doc
          - --disable-glade-catalogue
        sources:
          - type: archive
            url: https://github.com/thestinger/vte-ng/archive/0.56.2.a.tar.gz
            sha256: 28162f4318cb51a74070dbcc57b6900f7a1de2616cab843a2431fd5cb67fccb3
        cleanup:
          - '*'
        modules:
          - ../flathub-shared-modules/intltool/intltool-0.51.json
#     - name: vte3
#       buildsystem: meson
#       build-options:
#         env:
#           - CXXFLAGS=-fno-exceptions
#       sources:
#         - type: archive
#           url: https://download.gnome.org/sources/vte/0.60/vte-0.60.0.tar.xz
#           sha256: 72d1955eb40b4475b858892813a79545cee34409bac2af470606fb4b4d193a1b
#       cleanup:
#         - /bin
#         - /etc
#         - /include
#         - /lib/pkgconfig
#         - /lib/systemd
#         - /libexec
#         - /share/gir-1.0
#         - /share/vala
  - name: tmux
    sources:
      - type: archive
        url: https://github.com/tmux/tmux/releases/download/3.1c/tmux-3.1c.tar.gz
        sha256: 918f7220447bef33a1902d4faff05317afd9db4ae1c9971bef5c787ac6c88386
    modules:
      - name: libutempter
        no-autogen: true
        make-install-args:
          - libdir=/app/lib
          - libexecdir=/app/lib
          - includedir=/app/include
          - mandir=/app/share/man
        sources:
          - type: archive
            url: ftp://ftp.altlinux.org/pub/people/ldv/utempter/libutempter-1.2.1.tar.gz
            sha256: 967fef372f391de501843ad87570c6cf5dabd9651f00f1783090fbc12b2a34cb
      - name: libevent
        buildsystem: cmake
        sources:
          - type: archive
            url: https://github.com/libevent/libevent/releases/download/release-2.1.12-stable/libevent-2.1.12-stable.tar.gz
            sha256: 92e6de1be9ec176428fd2367677e61ceffc2ee1cb119035037a27d346b0403bb
